{% extends 'MSSCoreBundle:Home:base.html.twig' %}

{% block stylesheet %}
<link href="{{ asset('bundles/msscore/css/video-js.css') }}" rel="stylesheet">
<style type="text/css">
    .img-responsive, .thumbnail > img, .thumbnail a > img, .carousel-inner > .item > img, .carousel-inner > .item > a > img {
        height: 150px;
        width: 100%;
    }
    
    .portfolio-item {
        margin-bottom: 25px;
    }

    .full {
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        width:100%;
        height:700px;
        background-color:#999999;
    }
    
    .inner-full {
        margin-top:20px;
        width:950px;
        height:550px;
    }
    
    .box {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
    }
    
    .carousel {
        height:auto;
        width:100%;
    }
    
    .carousel-control{
      float:left;
      background: none !important; 
      text-shadow: none;
      opacity: 1;
      filter: alpha(opacity=100);
    }
    
    .carousel-control{
      float:right;
      background: none !important;
      text-shadow: none;
      opacity: 1;
      filter: alpha(opacity=100);
    }
    
    .carousel-control:hover, .carousel-control:focus {
      opacity: 1;
      filter: alpha(opacity=100);
    }
    
    .carousel .carousel-control { visibility: hidden; }
    .carousel:hover .carousel-control { visibility: visible; }
    
    .carousel-caption {
      padding: 0;
      margin:0;
      text-align:left;
    }
    
</style>
{% endblock %}

{% block javascript %}
<script src="{{ asset('bundles/msscore/js/video.js') }}"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script type="text/javascript">
    var myVideo = _V_("my_video_1");
    function changeMedia(obj){
                
        console.log(obj);
        var video = obj;
        var myVideo1 = document.getElementsByTagName('video')[0];
	var videoPlaying = myVideo1.currentSrc;
	var ext = videoPlaying.substr(videoPlaying.lastIndexOf("."));
        var prefix = "{{ asset('uploads/')}}";
	myVideo1.src =  prefix.concat(video.uploadprefix).concat(ext);
        $('#title').text(video.title);

	myVideo.load();
	myVideo.play();

            
    };
    
</script>
{% endblock %}

{% block content%}
<div class="container" style="margin-top:50px; width: 100%;">
   
    <div class="row">
        <div class="full">
            <div class="box">
                <div width="25%" height="550px">
                <div class="row" style="margin-top:20px"> 
                {% if playlist[0].coverpath is defined %}    
                <video id="my_video_1" class="video-js vjs-default-skin" controls preload="auto" width="950px" height="550px"
                       poster="{{ asset('bundles/msscore/' ~ playlist[0].coverpath) }}"
                       data-setup="{}">
                {% elseif playlist[0].framepath is defined %}
                <video id="my_video_1" class="video-js vjs-default-skin" controls preload="auto" width="950px" height="550px"
                    data-setup="{}">
                {% endif %}    
                  <source src="{{ asset('uploads/' ~ playlist[0].uploadprefix ~ '.webm') }}" type='video/webm' />
                  <source src="{{ asset('uploads/' ~ playlist[0].uploadprefix ~ '.mp4') }}" type='video/mp4' />
                </video>
                </div>
                <div class="row" style="justify-content: left;align-items: left;">
                    <h2 id="title" style="color:#ffffff;">{{ playlist[0].title }}</h2>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div style="margin-left:12%; margin-right:12%; margin-top:80px">
        <div class="row">
        <div class="col-md-12">
            <h1><small>PLAYLIST</small></h1>
            <input type="hidden" id="playlistInput" name="playlistInput" value="{{playlist|json_encode()}}"/>
            <hr class="featurette-divider" style="margin-top:0px; margin-bottom:50px;" >
            <div id="carousel-example-generic1" class="carousel slide">
            <div class="carousel-inner">
              
              {% set len = playlist|length%}
              {% if len > 1 %}  
              {% set rows = (len/4)|round %}
              {% for i in range(0, rows-1) %}  
              {% if i == 0 %}  
              <div class="item active" style="background-color: #ffffff; height: auto;">
              {% else %}
              <div class="item" style="background-color: #ffffff; height: auto;">    
              {% endif %}    
                  <div class="row">
                      {% for j in range(0,3) %}
                      {% set index = i*4+j %}
                      {% if index < len%}
                      {% set item = playlist[index] %}
                      <div class="col-sm-3 col-xs-6">
                          {% if item.framepath is defined %}
                          <a href="" onclick="changeMedia({{item|json_encode()}});return false;">
                            <img class="img-responsive" src="{{ asset('uploads/' ~ item.framepath) }}">
                            <div class="carousel-caption">{{ item.title|upper }}</div>
                          </a>
                          {% elseif item.coverpath is defined %}
                          <a href="" onclick="changeMedia({{item|json_encode()}});return false;">
                            <img class="img-responsive" src="{{ asset('bundles/msscore/' ~ item.coverpath) }}">
                            <div class="carousel-caption">{{ item.title|upper }}</div>
                          </a>
                          {% endif %}
                      </div>
                      {% endif %}
                      {% endfor %} 
                  </div>
              </div>
              {% endfor %}
              {% endif %}    
          </div>
            <!-- Controls -->
            <a class="left carousel-control" href="#carousel-example-generic1" data-slide="prev" style="left:-100px; color: #999999">
              <span class="glyphicon glyphicon-chevron-left"></span>
            </a>
            <a class="right carousel-control" href="#carousel-example-generic1" data-slide="next" style="right:-110px; color: #999999">
              <span class="glyphicon glyphicon-chevron-right"></span>
            </a>
        </div>
        </div>
        </div>
        </div> 
</div>
{% endblock %}